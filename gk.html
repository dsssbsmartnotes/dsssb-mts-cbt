<!DOCTYPE html>
<html>
<head>
<title>DSSSB MTS GK CBT</title>
<style>
body{font-family:arial;background:#f2f2f2;margin:0}
header{background:#0b2c4d;color:#fff;padding:15px;font-size:22px}
#box{display:flex}
#left{width:75%;padding:20px;background:#fff}
#right{
  position:fixed;
  top:55px;
  right:0;
  width:220px;
  background:#e9ecef;
  padding:10px;
  height:calc(100vh - 55px);
  overflow-y:auto;
}
.qbtn{width:40px;height:40px;margin:5px;border:none;background:#ccc;cursor:pointer}
.attempted{background:#4caf50;color:white}
.review{background:orange;color:black}
button{padding:10px;margin:5px}
#loginBox{background:white;padding:20px;text-align:center;}
</style>
</head>

<body>

<div id="loginBox">
<h2>DSSSB Assistant Superintendent – Login</h2>
<input id="cname" placeholder="Name" style="padding:10px;width:90%"><br><br>
<input id="croll" placeholder="Roll No" style="padding:10px;width:90%"><br><br>
<button onclick="startTest()" style="background:#0b2c4d;color:white;padding:10px 20px">Start Test</button>
</div>

<header id="topbar" style="display:none">
DSSSB GK CBT
<span id="timer" style="float:right">30:00</span>
<button onclick="togglePause()" style="float:right;margin-right:10px;background:red;color:white;border:none">⏸</button>
</header>

<div id="box" style="display:none">
<div id="left">
<h3 id="q"></h3>
<div id="opt"></div>
<button onclick="prev()">Previous</button>
<button onclick="next()">Next</button>
<button onclick="mark()">Mark</button>
<button onclick="submit()">Submit</button>
</div>
<div id="right"></div>
</div>

<script>
let qdata=[
["Sundari trees are found in?","Mangrove","Coniferous","Deciduous","None",0],
["Reservation article?","14","15(4)","16","21",1]
];

let i=parseInt(localStorage.getItem("qIndex"))||0;
let ans=JSON.parse(localStorage.getItem("answers"))||[];
let t=parseInt(localStorage.getItem("timeLeft"))||1800;
let paused=localStorage.getItem("paused")=="true";
let timer;

function startTest(){
 let n=cname.value,r=croll.value;
 if(!n||!r) return alert("Enter Name & Roll");

 localStorage.setItem("started","yes");
 localStorage.setItem("cname",n);
 localStorage.setItem("croll",r);
 localStorage.setItem("paused","false");

 loginBox.style.display="none";
 topbar.style.display="block";
 box.style.display="flex";
 buildPalette();
 load();
 startTimer();
}

if(localStorage.getItem("started")=="yes"){
 loginBox.style.display="none";
 topbar.style.display="block";
 box.style.display="flex";
 buildPalette();
 load();
 startTimer();
}

function startTimer(){
 if(paused) return;
 timer=setInterval(()=>{
  t--;
  localStorage.setItem("timeLeft",t);
  let m=Math.floor(t/60),s=t%60;
  timer.innerText=m+":"+(s<10?"0":"")+s;
  if(t<=0) submit();
 },1000);
}

function togglePause(){
 if(paused){paused=false;localStorage.setItem("paused","false");startTimer();}
 else{paused=true;localStorage.setItem("paused","true");clearInterval(timer);}
}

function buildPalette(){
 let p="";
 for(let j=0;j<qdata.length;j++) p+=`<button class="qbtn" id="b${j}" onclick="go(${j})">${j+1}</button>`;
 right.innerHTML=p;
}

function load(){
 let q=qdata[i];
 qEl=document.getElementById("q");
 qEl.innerText=(i+1)+". "+q[0];
 let o="";
 for(let k=1;k<=4;k++){
  let c=(ans[i]==k-1)?"checked":"";
  o+=`<label><input type="radio" ${c} onclick="sel(${k-1})"> ${q[k]}</label><br>`;
 }
 opt.innerHTML=o;
}

function sel(x){
 ans[i]=x;
 localStorage.setItem("answers",JSON.stringify(ans));
 localStorage.setItem("qIndex",i);
 document.getElementById("b"+i).classList.add("attempted");
}

function next(){if(i<qdata.length-1){i++;localStorage.setItem("qIndex",i);load();}}
function prev(){if(i>0){i--;localStorage.setItem("qIndex",i);load();}}
function go(n){i=n;localStorage.setItem("qIndex",i);load();}
function mark(){document.getElementById("b"+i).classList.add("review");}

function submit(){
 clearInterval(timer);

 let total=qdata.length, correct=0, wrong=0, attempted=0, notA=0, review=0;

 for(let j=0;j<total;j++){
  if(ans[j]==undefined) notA++;
  else{
    attempted++;
    if(ans[j]==qdata[j][5]) correct++;
    else wrong++;
  }
  if(document.getElementById("b"+j).classList.contains("review")) review++;
 }

 alert(
 "RESULT\n"+
 "Total: "+total+"\n"+
 "Attempted: "+attempted+"\n"+
 "Not Attempted: "+notA+"\n"+
 "Correct: "+correct+"\n"+
 "Wrong: "+wrong+"\n"+
 "Marked for Review: "+review+"\n"+
 "Score: "+correct+" / "+total
 );

 localStorage.clear();
 location.reload();
}
</script>

</body>
</html>

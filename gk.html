<!DOCTYPE html>
<html>
<head>
<title>DSSSB MTS GK CBT</title>
<style>
body{font-family:arial;background:#f2f2f2;margin:0}
header{background:#0b2c4d;color:#fff;padding:15px;font-size:22px}
#box{display:flex}
#left{width:75%;padding:20px;background:#fff}
#right{
  position:fixed;
  top:55px;
  right:0;
  width:220px;
  background:#e9ecef;
  padding:10px;
  height:calc(100vh - 55px);
  overflow-y:auto;
}
.qbtn{width:40px;height:40px;margin:5px;border:none;background:#ccc;cursor:pointer}
.attempted{background:#4caf50;color:white}
.current{border:2px solid red}
.review{background:orange;color:black}
.hidden{display:none}
button{padding:10px 15px;margin:10px}
#loginBox{background:white;padding:20px;text-align:center;}
</style>
</head>

<body>

<div id="loginBox">
<h2>DSSSB Assistant Superintendent – Candidate Login</h2>
<input id="cname" placeholder="Enter Name" style="padding:10px;width:90%;"><br><br>
<input id="croll" placeholder="Enter Roll Number" style="padding:10px;width:90%;"><br><br>
<button onclick="startTest()" style="background:#0b2c4d;color:white;padding:10px 20px;border:none;">Start Test</button>
</div>

<header id="topbar" style="display:none;">
DSSSB MTS – GK CBT
<span id="timer" style="float:right">30:00</span>
<button onclick="togglePause()" style="float:right;margin-right:10px;background:red;color:white;border:none;">⏸ Pause</button>
</header>

<div id="box" style="display:none;">
<div id="left">
<h3 id="q"></h3>
<div id="opt"></div>
<button onclick="prev()">Previous</button>
<button onclick="next()">Next</button>
<button onclick="mark()">Mark</button>
<button onclick="submit()">Submit</button>
</div>
<div id="right"></div>
</div>

<script>
let qdata=[
["Sundari trees are found in?","Mangrove","Coniferous","Deciduous","None",0,"Mangrove trees"],
["Reservation article?","14","15(4)","16","21",1,"Article 15(4)"]
];

let i=parseInt(localStorage.getItem("qIndex"))||0;
let ans=JSON.parse(localStorage.getItem("answers"))||[];
let t=parseInt(localStorage.getItem("timeLeft"))||1800;
let paused=localStorage.getItem("paused")=="true";
let timer;

function startTest(){
 if(!localStorage.getItem("started")){
  localStorage.setItem("started","yes");
  localStorage.setItem("timeLeft",t);
  localStorage.setItem("paused","false");
 }
 document.getElementById("loginBox").style.display="none";
 document.getElementById("topbar").style.display="block";
 document.getElementById("box").style.display="flex";
 buildPalette();
 load();
 startTimer();
}

function startTimer(){
 if(paused) return;
 timer=setInterval(()=>{
  t--;
  localStorage.setItem("timeLeft",t);
  let m=Math.floor(t/60),s=t%60;
  document.getElementById("timer").innerText=m+":"+(s<10?"0":"")+s;
  if(t<=0) submit();
 },1000);
}

function togglePause(){
 if(paused){
  paused=false;
  localStorage.setItem("paused","false");
  startTimer();
  alert("Resumed");
 }else{
  paused=true;
  localStorage.setItem("paused","true");
  clearInterval(timer);
  alert("Paused");
 }
}

function buildPalette(){
 let p="";
 for(let j=0;j<qdata.length;j++){
  p+=`<button class="qbtn" id="b${j}" onclick="go(${j})">${j+1}</button>`;
 }
 document.getElementById("right").innerHTML=p;
}

function load(){
 let q=qdata[i];
 document.getElementById("q").innerText=(i+1)+". "+q[0];
 let o="";
 for(let k=1;k<=4;k++){
  let c=(ans[i]==k-1)?"checked":"";
  o+=`<label><input type="radio" ${c} onclick="sel(${k-1})"> ${q[k]}</label><br>`;
 }
 document.getElementById("opt").innerHTML=o;
}

function sel(x){
 ans[i]=x;
 localStorage.setItem("answers",JSON.stringify(ans));
 localStorage.setItem("qIndex",i);
 document.getElementById("b"+i).classList.add("attempted");
}

function next(){if(i<qdata.length-1){i++;localStorage.setItem("qIndex",i);load();}}
function prev(){if(i>0){i--;localStorage.setItem("qIndex",i);load();}}
function go(n){i=n;localStorage.setItem("qIndex",i);load();}

function mark(){document.getElementById("b"+i).classList.add("review");}

function submit(){
 clearInterval(timer);
 localStorage.clear();
 alert("Test Submitted");
 location.reload();
}
</script>
</body>
</html>
